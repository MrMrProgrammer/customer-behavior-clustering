# -*- coding: utf-8 -*-
"""Clustering_ex.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DQLaHmGGXN3BZJB0hTQ3Edu_uhTZqZiw

<h1 dir=rtl align=center style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#0099cc">
خوشه‌بندی رفتار مشتریان</font>
</h1>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
فرض کنید شما تحلیل‌گر داده یک فروشگاه آنلاین هستید. دیتاستی در اختیار دارید که اطلاعات مربوط به سفارشات مشتریان را در آن ثبت کرده‌اید. با استفاده از روش‌های خوشه‌بندی، مشتریان را بر اساس رفتار خریدشان خوشه‌بندی کنید.
</font>
</p>

<h2 dir=rtl align=right style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#0099cc">
معرفی مجموعه داده
</font>
</h2>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
    در پوشه این تمربن یک فایل با نام <code>orders.csv</code> قرار دارد.
    مجموعه‌داده‌ی این سوال شامل ۲۰۰٬۰۰۰ سطر و ۷ ستون است و
    توضیحات مربوط به ستون‌ها به شرح زیر است:
</font>
</p>

<center>
<div dir=rtl style="direction: rtl;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>

| ستون | توضیح |
|:------:|:-------:|
| `ID_Order` | شناسه یکتای هر سفارش است. هر ردیف جدول نماینده یک سفارش خاص است. |
| `ID_Customer` | شناسه یکتای مشتری است که سفارش را ثبت کرده است. ممکن است یک مشتری چند سفارش داشته باشد. |
| `ID_Item` | شناسه یکتای آیتم یا محصول سفارش‌داده‌شده. در واقع مشخص می‌کند چه محصولی در سفارش آمده است. |
| `DateTime_CartFinalize` | زمان نهایی‌سازی سبد خرید است، یعنی لحظه‌ای که سفارش نهایی شده. این ستون برای استخراج اطلاعات زمانی (مثلاً فصل خرید، ساعت روز، روز هفته) می‌تواند کاربردی باشد. |
| `Amount_Gross_Order` | مبلغ ناخالص سفارش به تومان یا هر واحد پولی دیگر. شامل کل هزینه سفارش (شاید بدون تخفیف یا مالیات). |
| `city_name_fa` | نام فارسی شهری که سفارش از آن ثبت شده. |
| `Quantity_item` | تعداد آیتم سفارش‌داده‌شده از آن محصول در سفارش. |

</font>

<h2 align=right style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#0099cc">
خواندن مجموعه داده
</font>
</h2>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
    در ابتدا نیاز است فایل مجموعه‌داده را بخوانید.  مجموعه داده تمرین، در فایل <code>orders.csv</code> ذخیره شده‌است.
</font>
</p>
"""

import pandas as pd
import numpy as np

"""<h2 align=right style="line-height:200%;font-family:vazir;color:#ff1111">
<font face="vazirmatn" color="#ff1111">
پیش‌پردازش و مهندسی ویژگی
</font>
</h2>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
     شما می‌توانید از هر تکنیک پیش‌پردازش/مهندسی ویژگی که صلاح می‌دانید، استفاده کنید.
</font>
</p>








"""







"""<h2 dir=rtl align=right style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#0099cc">
انتخاب تعداد خوشه‌ها و آموزش مدل
</font>
</h2>

<p dir=rtl style="direction: rtl;text-align: justify;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>
    حال که داده را پاکسازی کرده و احتمالا ویژگی‌هایی را به آن افزوده یا از آن حذف کرده‌اید، وقت آن است که ابتدا براساس روش‌هایی که می‌دانید تعداد خوشه‌های مناسب برای این سوال را پیدا کنید و سپس بر اساس آن مدلی آموزش دهید
     
</font>
</p>
"""

# انتخاب تعداد خوشه‌ها

# انتخاب تعداد خوشه‌ها

# خوشه‌بندی نهایی

# خوشه‌بندی نهایی



"""<h2 align=right style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#ff1111">
 پیش‌بینی برای داده تست و خروجی
</font>
</h2>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
    پس از مهندسی ویژگی و مدل‌سازی، الگوریتمی دارید که می‌تواند شما را از متغیرهای هر نمونه، به خوشه آن برساند.
    <br>
    از این مدل برای پیش‌بینی خوشه نمونه‌های موجود در داده <b><i>orders.csv</i></b> استفاده کنید و نتایج را در قالب جدول زیر آماده کنید.
</font>
</p>

<center>
<div dir=rtl style="direction: rtl;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>
    
|ستون|توضیحات|
|:------:|:---:|
|Cluster|خوشه منتصب به هر نمونه|
    
</font>
</div>
</center>

<p dir=rtl style="direction: rtl;text-align: right;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>
    <br>
    این دیتافریم تنها شامل ۱ ستون با اسم <i>Cluster</i> است و ۲۰۰٬۰۰۰ سطر دارد.
    <br>
    به ازای هر سطر موجود در فایل <i>orders.csv</i> شما باید یک مقدار پیشبینی شده داشته باشید.
</font>
</p>



<p dir=rtl style="direction: rtl; text-align: center; line-height:200%; font-family:vazir; font-size:medium; color:#ff1111">
<font face="vazirmatn" size=4 color:"#ff1111">
    در این تمرین، مجموعه داده‌هایی جداگانه برای آزمون یا آموزش نداریم و شما باید خروجی مدل خود را برای همان مجموعه داده‌ای که در اول تمرین، از فایل بارگذاری کردید، در دیتافریم  ذخیره کنید.
</font>
</p>

<p dir=rtl style="direction: rtl;text-align: right;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>
    جدول زیر، ۵ سطر ابتدایی دیتافریم  را نشان می‌دهد. البته در جواب شما، اعداد ستون <i>Cluster</i> ممکن است متفاوت باشد.
</font>
</p>


<div style="text-align: right;line-height:200%;font-family:vazir;font-size:medium">
<font face="vazirmatn" size=3>
    
||Cluster|
|:----:|:-----:|
|0|1|
|1|1|
|2|0|
|3|1|
|4|0|

</font>
</div>
"""





"""<h3 align=right style="line-height:200%;font-family:vazir;color:#0099cc">
<font face="vazirmatn" color="#0099cc">
معیار ارزیابی
</font>
</h3>

<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font face="vazirmatn" size=3>
    معیار <code>silhouette score</code> را برای ارزیابی کیفیت مدل خود محاسبه کنبد .
    <br>
    
</font>
</p>
"""





"""<p dir=rtl style="direction: rtl; text-align: justify; line-height:200%; font-family:vazir; font-size:medium">
<font color="red"><b color='red'>توجه:</b></font>
<font face="vazirmatn" size=3>
 جهت کسب امتیاز کامل نیاز است تا پاسخ شما حداقل امتیاز <code>85</code> را با توجه به معیار معرفی‌شده کسب نماید.
</font>
</p>
"""



print( 100 * (sil_score + 1 ) / 2 )

